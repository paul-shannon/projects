tbl.fp <- getFootprintsInRegion(fpf, "chr5", 88822685, 89011824)
as.data.frame(t(tbl.fp[1:2,]))
tbl.fp[1:5, c("chrom", "start", "end", "name", "score3")]
tbl.fp[1:5, c("chrom", "start", "endpos", "name", "score3")]
dim(tbl.bed)
library("TxDb.Hsapiens.UCSC.hg38.knownGene")
biocLite("TxDb.Hsapiens.UCSC.hg38.knownGene")
biocGet <- function(pkgName){source("http://bioconductor.org/biocLite.R"); biocLite(pgkName)}

biocGet("TxDb.Hsapiens.UCSC.hg38.knownGene")
biocGet <- function(pkgName){source("http://bioconductor.org/biocLite.R"); biocLite(pkgName)}

biocGet("TxDb.Hsapiens.UCSC.hg38.knownGene")
biocGet("TxDb.Hsapiens.UCSC.hg38.knownGene")
biocGet("TxDb.Hsapiens.UCSC.hg38.knownGene")
biocGet("TxDb.Hsapiens.UCSC.hg38.knownGene")
biocGet("TxDb.Hsapiens.UCSC.hg38.knownGene")
a
library(TxDb.Hsapiens.UCSC.hg19.knownGene)
seqlevels(seqinfo(TxDb.Hsapiens.UCSC.hg19.knownGene))


   chrom.lengths <- as.list(seqlengths(seqinfo(TxDb.Hsapiens.UCSC.hg19.knownGene))[paste("chr", c(1:22, "X", "Y"), sep="")])

chrom.lengths
names(chrom.lengths)
dim(tbl.fp)
chrom
end.loc
Q
q()
dim(tbl.fp)
wdth(1024)
head(tbl.fp)
nrow(tbl.fp)
length(unique(tbl.fp$loc))
head(duplicated(tbl.fp$loc))
head(which(duplicated(tbl.fp$loc)))
tbl.fp$loc[6]
grep(tbl.fp$loc[6], tbl.fp$loc)
tbl.fp[grep(tbl.fp$loc[6], tbl.fp$loc),]
x <- table(tbl.fp$loc)
length(x)
head(x)
table(as.integer(x))
save(tbl.fp, file="tbl.fp.chr22.RData")
tbl.fp22 <- tbl.fp
save(tbl.fp22, file="tbl.fp.chr22.RData")
table(head(tbl.fp$loc, n=100))
table(head(tbl.fp$loc, n=10))
table(tbl.fp$loc[80:90])
table(tbl.fp$loc[90:100])
dim(tbl.test)
tbl.test
Q
source("go.R")
source("go.R")
test.condense.footprints()
dim(tbl.fp)
wdth(1024)
tbl.fp
as.data.frame(table(tbl.fp$loc))
colnames(tbl.reps) <- c("loc", "score")
tbl.resp
tbl.reps
lapply(tbl.reps$loc, function(loc) subset(tbl.fp, loc==loc)[1, c("chrom", "start", "endpos")])
as.data.frame(lapply(tbl.reps$loc, function(loc) subset(tbl.fp, loc==loc)[1, c("chrom", "start", "endpos")]))
rbind(lapply(tbl.reps$loc, function(loc) subset(tbl.fp, loc==loc)[1, c("chrom", "start", "endpos")]))
do.call(rbind,lapply(tbl.reps$loc, function(loc) subset(tbl.fp, loc==loc)[1, c("chrom", "start", "endpos")])))
do.call(rbind,lapply(tbl.reps$loc, function(loc) subset(tbl.fp, loc==loc)[1, c("chrom", "start", "endpos")]))
tbl.reps
tbl.chromLoc
do.call(rbind,lapply(tbl.reps$loc, function(loc) subset(tbl.fp, loc==loc)[1, c("chrom", "start", "endpos")]))
lapply(tbl.reps$loc, function(loc) subset(tbl.fp, loc==loc)[1, c("chrom", "start", "endpos")])
lapply(tbl.reps$loc, function(loc) subset(tbl.fp, loc==loc)
)
dim(tbl.fp)
length(tbl.reps$loc)
tbl.reps
tbl.chromLoc
tbl.out
tbl.fp
tbl.out
?table
dim(tbl.test)
tbl.test
tbl.test
unique(tbl.test[, c("loc", "sample_id")])
table(unique(tbl.test[, c("loc", "sample_id")])$loc)
table(unique(tbl.test[, c("loc", "sample_id")])$loc)
wdth(840)
table(unique(tbl.test[, c("loc", "sample_id")])$loc)
wdth(600)
table(unique(tbl.test[, c("loc", "sample_id")])$loc)
as.data.frame(table(unique(tbl.test[, c("loc", "sample_id")])$loc))
x <-as.data.frame(table(unique(tbl.fp22[, c("loc", "sample_id")])$loc))
dim(x)
dim(tbl.fp22)
tbl.freq <- table(x$loc, x$sample_id)
dim(tbl.feq)
dim(tbl.freq)
colnames(x)
tbl.uniq <- unique(tbl.fp22[, c("loc", "sample_id")])
dim(tbl.uniq)
head(tbl.uniq
)
source("go.R"); test.condense.footprints()
n
dim(tbl.fp); dim(tbl.fp$uniq)
dim(tbl.fp); dim(tbl.fp.uniq)
dim(tbl.reps)
head(tbl.reps)
table(tbl.reps$Freq)
dim(tbl.repsOfInterest)
head(tbl.repsOfInterest)
dim(tbl.repsOfInterest)
  tbl.chromLoc <- do.call(rbind,lapply(head(tbl.repsOfInterest$Var1), function(loc) subset(tbl.fp, loc==loc)[1, c("chrom", "start", "endpos")]))
tbl.chromLoc
head(tbl.repsOfInterest)
  tbl.chromLoc <- do.call(rbind,lapply(head(tbl.repsOfInterest$Var1), function(unique.loc) subset(tbl.fp, loc==unique.loc)[1, c("chrom", "start", "endpos")]))
tbl.chromLoc
  tbl.chromLoc <- do.call(rbind,lapply((tbl.repsOfInterest$Var1), function(unique.loc) subset(tbl.fp, loc==unique.loc)[1, c("chrom", "start", "endpos")]))
head(tbl.repsOfInterest)
tbl.repsOfInterest$Var1[1]
tbl.repsOfInterest$Var1[1]
tbl.repsOfInterest$Var1[1]
grep(tbl.repsOfInterest$Var1[1], tbl.fp$loc)
grep(tbl.repsOfInterest$Var1[1], tbl.fp$loc)[1]
tbl.fp[grep(tbl.repsOfInterest$Var1[1], tbl.fp$loc)[1], c("chrom", "start", "endpos")]
grep(tbl.repsOfInterest$Var1[1], tbl.fp$loc)
match(tbl.repsOfInterest$Var1[1], tbl.fp$loc)
dim(tbl.repsOfInterest)
chromStartEndList
dim(tbl.chromStartEndList)
tbl.chromStartEndList
tbl.repsOfInterest
head(tbl.repsOfInterest, n=10)
tbl.chromStartEndList
lapply(tbl.chromStartEndList, class)
lapply(tbl.repsOfInterest)
lapply(tbl.repsOfInterest, class)
dim(tbl.out)
tbl.out
lapply(tbl.out, class)
tbl.out
dim(tbl.out)
head(tbl.out)
table(tbl.out$score)
head(tbl.repsOfInterest$Var1)
match(head(tbl.repsOfInterest$Var1), tbl.fp$loc)
length(indices)
dim(tbl.out)
head(tbl.out)
Q
source("go.R"); test.condense.footprints()
n
n
n
n
n
n
n
dim(tbl.out)
n
source("go.R"); test.condense.footprints()
dim(tbl.out)
dim(tbl.condensed)
dim(tbl.test)
head(tbl.condensed)
length(unique(tbl.condensed$loc))
Q
source("go.R"); test.condense.footprints()
colnames(tbl.condensed)
source("go.R"); iterate()
source("go.R"); iterate()
source("go.R"); test.condense.footprints(); iterate()
chrom.lengths[["chr22"]]
source("go.R")
iterate()
reload("go.R"); iterate()
source("go.R"); iterate()
library(Rsamtools)
tbl.filename <- indexTabix("brain_hint.bed", format="bed")
tbl.filename <- indexTabix("brain_hint.bed.gz", format="bed")
tbl.filename <- indexTabix("brain_hint.bed.gz", format="bed")
q()
library(Rsamtools)
tbl.filename <- indexTabix("brain_hint.bed.gz", format="bed")
tbl.filename <- indexTabix("brain_hint.bed.gz", format="bed")
q()
library(Rsamtools)
tbl.filename <- indexTabix("brain_hint.bed.gz", format="bed")
q()
source("go.R")
runTests()
source("go.R"); iterate()
library(Rsamtools)
tbl.filename <- indexTabix("brain_hint_chr2_all.bed.gz", format="bed")  
